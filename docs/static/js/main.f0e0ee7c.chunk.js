(this["webpackJsonpfilter-bookmarks"]=this["webpackJsonpfilter-bookmarks"]||[]).push([[0],{138:function(e,t,a){},139:function(e,t,a){},144:function(e,t,a){"use strict";a.r(t);var n=a(13),s=a(14),l=a(16),i=a(15),o=a(17),r=(a(82),a(0)),c=a(78),u=a(1),d=a(80),m=a(18),g=function(e){function t(){var e,a;Object(n.a)(this,t);for(var s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(o)))).state={bg:"#000000",button:"#000000",clear:!1,filters:[],image:{name:"",ext:"",data:""},label:"Revert Filters",saved:!1,style:"text",text:"#000000",useSelectedWS:!1,selectWSList:[],worksheets:[]},a.labelChange=function(e){var t=e.target.value;a.setState({label:t});try{window.tableau.extensions.settings.set("label",t),window.tableau.extensions.settings.saveAsync()}catch(n){console.log(n)}},a.styleChange=function(e){var t=e.target.value;a.setState({style:t});try{window.tableau.extensions.settings.set("style",t),window.tableau.extensions.settings.saveAsync()}catch(n){console.log(n)}},a.setImage=function(e){var t;if(e.target.files&&(t=e.target.files[0]),t){var n=/(?:\.([^.]+))?$/.exec(t.name)[1],s=t.name.slice(0,-n.length);if(t&&["image/gif","image/jpeg","image/png"].includes(t.type)){var l=new FileReader;l.addEventListener("load",(function(){if(l.result){var e=l.result.substring(l.result.search(",")+1),t={name:s,ext:n,data:e};a.setState({image:t}),window.tableau.extensions.settings.set("image",JSON.stringify(t)),window.tableau.extensions.settings.saveAsync()}}),!1),t&&l.readAsDataURL(t)}else alert("The selected file is not a .gif, .jpg, .jpeg, or .png")}},a.bgChange=function(e){a.setState({bg:e.target.value}),window.tableau.extensions.settings.set("bg",e.target.value),window.tableau.extensions.settings.saveAsync()},a.buttonChange=function(e){a.setState({button:e.target.value}),window.tableau.extensions.settings.set("button",e.target.value),window.tableau.extensions.settings.saveAsync()},a.textChange=function(e){a.setState({text:e.target.value}),window.tableau.extensions.settings.set("text",e.target.value),window.tableau.extensions.settings.saveAsync()},a.clearChange=function(e){a.setState({clear:e.target.checked}),window.tableau.extensions.settings.set("clear",e.target.checked),window.tableau.extensions.settings.saveAsync()},a.useSelectedWSChange=function(e){a.setState({useSelectedWS:e.target.checked}),window.tableau.extensions.settings.set("useSelectedWS",e.target.checked),window.tableau.extensions.settings.saveAsync()},a.updateWSSelection=function(e){var t=e.target.innerText,n=a.state.selectWSList.includes(t),s=a.state.selectWSList;n?s=s.filter((function(e){return e!==t})):s.push(t),a.setState({selectWSList:s}),window.tableau.extensions.settings.set("selectWSList",JSON.stringify(s)),window.tableau.extensions.settings.saveAsync()},a.getFilters=function(){console.log("getting filters");var e=[],t=[];window.tableau.extensions.dashboardContent.dashboard.worksheets.forEach((function(t){e.push(t.getFiltersAsync())})),Promise.all(e).then((function(e){e.forEach((function(e){e.forEach((function(e){t.push(e)}))})),a.constructSettings(t)}))},a.submit=function(){var e=window.tableau.extensions.dashboardContent.dashboard.worksheets,t=a.state.selectWSList.filter((function(t){return void 0!==e.find((function(e){return e.name===t}))})),n=a.state.label||"Revert Filters";window.tableau.extensions.settings.set("label",n),window.tableau.extensions.settings.set("style",a.state.style),window.tableau.extensions.settings.set("image",JSON.stringify(a.state.image)),window.tableau.extensions.settings.set("configured","true"),window.tableau.extensions.settings.set("selectWSList",JSON.stringify(t)),window.tableau.extensions.settings.saveAsync().then((function(){window.tableau.extensions.ui.closeDialog("closed")}))},a}return Object(o.a)(t,e),Object(s.a)(t,[{key:"constructRangeSetting",value:function(e){var t,a=e.minValue.value,n=e.maxValue.value,s="object"===typeof e.maxValue.value||"object"===typeof e.minValue.value?"date":"number",l="Null"===e.maxValue.formattedValue&&"Null"===e.minValue.formattedValue?"all-values":"";return t=!(void 0!==e.minValue.value&&!e.fieldName.startsWith("Action (")),{dataType:s,fieldName:e.fieldName,filterType:e.filterType,max:0===n?1e-13:n,min:0===a?1e-13:a,nullOption:l,skip:t,worksheetName:e.worksheetName}}},{key:"constructCategoricalSetting",value:function(e){var t,a=[],n=!0,s=!1,l=void 0;try{for(var i,o=e.appliedValues[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var r=i.value;a.push(r.formattedValue)}}catch(u){s=!0,l=u}finally{try{n||null==o.return||o.return()}finally{if(s)throw l}}var c=0===a.length?"all":"replace";return t=!("Measure Names"!==e.fieldName&&!e.fieldName.startsWith("Action (")),{appliedValues:a,fieldName:e.fieldName,filterType:e.filterType,isExcludeMode:e.isExcludeMode,skip:t,updateType:c,worksheetName:e.worksheetName}}},{key:"constructSettings",value:function(e){var t=this,a=[],n=!0,s=!1,l=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var r=i.value;switch(r.filterType){case"range":a.push(this.constructRangeSetting(r));break;case"categorical":a.push(this.constructCategoricalSetting(r));break;default:continue}}}catch(c){s=!0,l=c}finally{try{n||null==o.return||o.return()}finally{if(s)throw l}}window.tableau.extensions.settings.set("filters_set","true"),window.tableau.extensions.settings.set("filters",JSON.stringify(a)),window.tableau.extensions.settings.saveAsync().then((function(){t.setState({saved:!0}),setTimeout((function(){t.setState({saved:!1})}),1e3)}))}},{key:"componentWillMount",value:function(){var e=this;window.tableau.extensions.initializeDialogAsync().then((function(){var t=window.tableau.extensions.settings.getAll(),a=t.image?JSON.parse(t.image):e.state.image;e.setState({bg:t.bg,button:t.button,clear:"true"===t.clear,label:t.label,style:t.style||"text",image:a,text:t.text,useSelectedWS:"true"===t.useSelectedWS,selectWSList:t.selectWSList&&JSON.parse(t.selectWSList)||[],worksheets:window.tableau.extensions.dashboardContent.dashboard.worksheets}),"true"!==t.configured&&e.getFilters()}))}},{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement("div",{className:"container"},r.createElement("div",null,r.createElement("div",{className:"header"},"Filter Bookmarks Configuration",r.createElement("div",{className:"tooltip"},r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",id:"Dialogs_x5F_Info",width:"15",height:"15",viewBox:"0 0 15 15"},r.createElement("rect",{id:"Line",x:"7",y:"6",width:"1",height:"5",fillRule:"evenodd",clipRule:"evenodd",fill:"#666766"}),r.createElement("rect",{id:"Dot_2_",x:"7",y:"4",width:"1",height:"1",fillRule:"evenodd",clipRule:"evenodd",fill:"#666766"}),r.createElement("path",{id:"Circle",d:"M7.5,1C3.9,1,1,3.9,1,7.5S3.9,14,7.5,14 S14,11.1,14,7.5S11.1,1,7.5,1z M7.5,13C4.5,13,2,10.5,2,7.5C2,4.5,4.5,2,7.5,2S13,4.5,13,7.5C13,10.5,10.5,13,7.5,13z",fillRule:"evenodd",clipRule:"evenodd",fill:"#666766"})),r.createElement("span",{className:"tooltiptext"},r.createElement("b",null,"How to Use"),r.createElement("ol",null,r.createElement("li",null,"Set your dashboard filters they way you want to be able to revert to."),r.createElement("li",null,'Open the configuration window and click "Save Settings".')),r.createElement("p",null,"Optional: Customize your buttons label and colors."),r.createElement("p",null,'If you simply want to clear all filters with this button, turn on that setting under "Options".'),r.createElement("p",null,"Note: You can add as many instances of this extension as you like!")))),r.createElement("div",null,r.createElement("div",{className:"title",style:{marginTop:"18px"}},"Button Settings"),r.createElement("div",{className:"section"},r.createElement("label",{className:"label"},"Button Style"),r.createElement(m.DropdownSelect,{className:"dropdown-select",kind:"line",onChange:this.styleChange,onSelect:this.styleChange,value:this.state.style},r.createElement("option",{value:"image"},"Image button"),r.createElement("option",{value:"text"},"Text button")),r.createElement(m.TextField,{className:"label-text-field",style:{display:"text"===this.state.style?"inline-flex":"none"},kind:"line",label:"Label",onChange:this.labelChange,value:this.state.label}),r.createElement("div",{className:"inputBox",style:{display:"image"===this.state.style?"inline-flex":"none"}},r.createElement("span",{className:"imgName ellipsis"},""!==this.state.image.name?this.state.image.name:"Choose an image..."),r.createElement("span",{className:"imgExt"},""!==this.state.image.ext?this.state.image.ext:""),r.createElement("input",{className:"imgInput",type:"file",accept:".gif,.jpg,.jpeg,.png",id:"imgInput",onChange:this.setImage}),r.createElement("label",{className:"imgLabel",htmlFor:"imgInput"},"Choose")),this.state.clear?r.createElement("p",null,"Currently clearing all filters."):r.createElement("p",null,"Click ",r.createElement("b",null,"Save Settings")," to save current filters."),r.createElement("div",{className:"set"},r.createElement(m.Button,{onClick:this.getFilters,disabled:this.state.clear},"Save Settings"),r.createElement("span",{className:this.state.saved?"saved show":"saved"},"Settings saved!"))),r.createElement("div",{className:"title"},"Options"),r.createElement("div",{className:"section"},r.createElement(m.Checkbox,{checked:this.state.clear,onChange:this.clearChange,style:{flexGrow:1}},"Ignore settings and just clear all filters."),r.createElement(m.Checkbox,{checked:this.state.useSelectedWS,onChange:this.useSelectedWSChange,style:{flexGrow:1}},"Only reset filters on selected worksheets."),r.createElement("div",{className:"listBox",style:{display:this.state.useSelectedWS?"flex":"none"}},r.createElement("div",{className:"list scrolly"},this.state.worksheets.map((function(t){return r.createElement(m.Pill,{kind:"discrete",schema:!0,selected:e.state.selectWSList.includes(t.name),onMouseDown:e.updateWSSelection,children:t.name,key:t.name,title:t.name,style:{marginBottom:"4px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"block",lineHeight:"18px"},"data-type":"worksheet"})}))))),r.createElement("div",{className:"title"},"Formatting"),r.createElement("div",{className:"section"},r.createElement("div",{className:"format"},r.createElement("div",{className:"ftext"},"Background Color"),r.createElement("div",null,r.createElement("input",{type:"color",value:this.state.bg,onChange:this.bgChange,style:{backgroundColor:this.state.bg}}))),r.createElement("div",{className:"format"},r.createElement("div",{className:"ftext"},"Text Button Color"),r.createElement("div",null,r.createElement("input",{type:"color",value:this.state.button,onChange:this.buttonChange,style:{backgroundColor:this.state.button}}))),r.createElement("div",{className:"format"},r.createElement("div",{className:"ftext"},"Text Button Text Color"),r.createElement("div",null,r.createElement("input",{type:"color",value:this.state.text,onChange:this.textChange,style:{backgroundColor:this.state.text}})))))),r.createElement("div",{className:"footer"},r.createElement("div",{className:"btncluster"},r.createElement(m.Button,{kind:"filledGreen",onClick:this.submit,style:{marginLeft:"12px"}},"OK")))))}}]),t}(r.Component),h={name:"default",ext:".png",data:"iVBORw0KGgoAAAANSUhEUgAAAD4AAAAaCAYAAADv/O9kAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH5AMbFhQgjNJxJQAAAPFJREFUWIXtlC8LwlAUR3/+QWEDwTAwiYgIWzKsrwkW04LNYDLbBe1+BIPtZYtV+4JpYYgMk7Bg2kBBNK1NTd47eO98gXMP791bWIT7l59EkAlLM1CULRoA/CRCkXsILlS4bKhw2VDh/8fGqutgQCf8Cu2LlwyMTReibZNqs+D56tUWhOli3eyw6AHmHdf1HoQ5xLxO787BcavAargQZh9TQmsOwlNqcAh3v0xm+sgD/nWL5Y3Wyhoex0dMLicWN0/4PcTo7LGoU2jDnxE2wQE7Umk2hOEeZgGd7Rc5uuq0qHDZUOGyIW+4pRncM5BjaQbeyHkrIkfBCTEAAAAASUVORK5CYII="};var f=function(e){function t(){var e,a;Object(n.a)(this,t);for(var s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(o)))).state={bg:"#ffffff",button:"#2DCC97",clear:!1,configured:!1,filters:[],image:{name:"",ext:"",data:""},label:"Revert Filters",style:"text",text:"#ffffff",useSelectedWS:!1,selectWSList:[]},a.applyFilters=function(){var e=window.tableau.extensions.dashboardContent.dashboard,t=window.tableau.extensions.settings.getAll();if("true"===t.clear)a.clearFilters();else{var n=JSON.parse(t.filters),s=!0,l=!1,i=void 0;try{for(var o,r=function(){var t=o.value;if(!1===t.skip&&(!a.state.useSelectedWS||a.state.selectWSList.includes(t.worksheetName)))switch(t.filterType){case"range":var n={};n="all-values"===t.nullOption?{nullOption:t.nullOption}:"date"===t.dataType?{min:t.min?new Date(t.min):null,max:t.max?new Date(t.max):null}:{min:t.min,max:t.max},e.worksheets.find((function(e){return e.name===t.worksheetName})).applyRangeFilterAsync(t.fieldName,n).catch((function(){return console.log("Failed to set range filter [".concat(t.fieldName,"] to [").concat(n,"] on worksheet [").concat(t.worksheetName,"]"))}));break;case"categorical":e.worksheets.find((function(e){return e.name===t.worksheetName})).applyFilterAsync(t.fieldName,t.appliedValues,t.updateType,{isExcludeMode:t.isExcludeMode}).catch((function(){return console.log("Failed to set categorical filter [".concat(t.fieldName,"] to [").concat(t.appliedValues,"] on worksheet [").concat(t.worksheetName,"]"))}));break;default:return"continue"}},c=n[Symbol.iterator]();!(s=(o=c.next()).done);s=!0)r()}catch(u){l=!0,i=u}finally{try{s||null==c.return||c.return()}finally{if(l)throw i}}}},a}return Object(o.a)(t,e),Object(s.a)(t,[{key:"clearFilters",value:function(){window.tableau.extensions.dashboardContent.dashboard.worksheets.forEach((function(e){e.getFiltersAsync().then((function(t){var a=[];t.forEach((function(t){a.push(e.clearFilterAsync(t.fieldName))}))}))}))}},{key:"configure",value:function(){var e="".concat(window.location.origin).concat("/extension-filter-bookmarks","/#/config");window.tableau.extensions.ui.displayDialogAsync(e,"",{height:540,width:300}).catch((function(e){switch(e.errorCode){case window.tableau.ErrorCodes.DialogClosedByUser:console.log("Dialog was closed by user.");break;default:console.error(e.message)}}))}},{key:"updateSettings",value:function(e){var t=e.image?JSON.parse(e.image):h;this.setState({bg:e.bg,button:e.button,configured:"true"===e.configured,filters:JSON.parse(e.filters),label:e.label,style:e.style||"text",image:t,text:e.text,useSelectedWS:"true"===e.useSelectedWS,selectWSList:e.selectWSList&&JSON.parse(e.selectWSList)||[]})}},{key:"componentWillMount",value:function(){var e=this;window.tableau.extensions.initializeAsync({configure:this.configure}).then((function(){window.tableau.extensions.settings.addEventListener(window.tableau.TableauEventType.SettingsChanged,(function(t){e.updateSettings(t.newSettings)})),"true"===window.tableau.extensions.settings.getAll().configured?e.updateSettings(window.tableau.extensions.settings.getAll()):(window.tableau.extensions.settings.set("bg",e.state.bg),window.tableau.extensions.settings.set("button",e.state.button),window.tableau.extensions.settings.set("clear",e.state.clear),window.tableau.extensions.settings.set("label",e.state.label),window.tableau.extensions.settings.set("image",JSON.stringify(e.state.image)),window.tableau.extensions.settings.set("style",e.state.style),window.tableau.extensions.settings.set("text",e.state.text),window.tableau.extensions.settings.set("useSelectedWS",e.state.useSelectedWS),window.tableau.extensions.settings.set("selectWSList",JSON.stringify(e.state.selectWSList)),window.tableau.extensions.settings.saveAsync().then((function(){e.configure()})))}))}},{key:"render",value:function(){var e="",t="",a=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{b:parseInt(t[3],16),g:parseInt(t[2],16),r:parseInt(t[1],16)}:null}(this.state.button);a&&(e="rgb(".concat(Math.floor(a.r),", ").concat(Math.floor(a.g),", ").concat(Math.floor(a.b),")"),t="rgba(".concat(Math.floor(a.r),", ").concat(Math.floor(a.g),", ").concat(Math.floor(a.b),", .8)"));var n="\n            button.button:active {\n                background-color: ".concat(e," !important;\n            }\n        "),s=r.createElement("button",{className:"button",onClick:this.applyFilters,style:{backgroundColor:t,color:this.state.text}},this.state.label),l=r.createElement("img",{src:""!==this.state.image.data?"data:image/png;base64, ".concat(this.state.image.data):"data:image/png;base64, ".concat(h.data),style:{cursor:"pointer",maxWidth:"100%",objectFit:"contain"},onClick:this.applyFilters,alt:"Filter"});return r.createElement("div",{className:"outer",style:{backgroundColor:this.state.bg,display:this.state.configured?"flex":"none"}},r.createElement("div",{className:"inner"},r.createElement("style",null,n),"image"===this.state.style?l:s))}}]),t}(r.Component),b=(a(138),function(e){function t(){return Object(n.a)(this,t),Object(l.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement("div",{className:"icontainer"},r.createElement("div",{className:"box"},r.createElement("div",{className:"left"},r.createElement("h1",{className:"iheader"},"Filter Bookmarks"),r.createElement("span",{className:"tagline"},"Instantly revert your dashboards to predefined filter settings.")),r.createElement("div",{className:"right"},r.createElement("h4",{className:"big"},"What is it?"),r.createElement("p",null,"This extension enables you to add a button directly into your dashboard that resets to certain filter settings. Great for embedded dashboards that do not have the toolbar showing or for a more intuitive interface."),r.createElement("h4",{className:"big"},"Using the Extension"),r.createElement("ol",null,r.createElement("li",null,"Set your dashboard filters they way you want to be able to revert to."),r.createElement("li",null,'Open the configuration window and click "Save Settings".'),r.createElement("li",null,"Optional: Customize your buttons label and colors.")),r.createElement("p",null,r.createElement("b",null,"Note:")," You can add as many instances of this extension as you like!"),r.createElement("div",{className:"gh"},"Get this extension and more in the ",r.createElement("a",{href:"https://extensiongallery.tableau.com/"},"Extension Gallery"),".")))))}}]),t}(r.Component)),w=(a(139),function(){return r.createElement(r.Fragment,null,r.createElement(u.a,{path:"/",exact:!0,component:b}),r.createElement(u.a,{path:"/bookmarks",component:f}),r.createElement(u.a,{path:"/config",component:g}))}),p=function(e){function t(){return Object(n.a)(this,t),Object(l.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.createElement(d.a,null,r.createElement(w,null))}}]),t}(r.Component);c.render(r.createElement(p,null),document.getElementById("container"))},81:function(e,t,a){e.exports=a(144)}},[[81,1,2]]]);
//# sourceMappingURL=main.f0e0ee7c.chunk.js.map